<div class="rs-component dnd-component dialog-dnd-damage">
	<!-- All selections depend on the passed entity -->
	<div class="progress flex h">
		<button class="section-tab flat action rs-white" v-for="section in prepared" v-on:click="goToSection(section)">
			<span>{{section.name}}</span>
			<span class="section-tab-icon fa-solid fa-chevron-right" v-if="sections[section.index + 1] && section.index !== activeSection.index"></span>
		</button>
		<button class="rounded quick action" v-on:click="finishSection(activeSection)">
			<span class="action-icon fa-solid" :class="sections[activeSection.index + 1]?'fa-chevrons-right':'fa-upload'"></span>
		</button>
	</div>
	<div class="declaring">
		<div class="declaration-slider flex h" :class="activeSection.classing">
			<section class="page channels">
				<div class="page-contents">
					<div class="section-heading">
						<span>Method</span>
					</div>
					<!-- This may be passed in as an object "channel" or "method" (preferably channel but method makes more sense as plain english, avoiding for javascript method confusion)-->
					<div class="channel none flex h" v-on:click="selectChannel(null)">
						<button class="general rounded quick action spells">
							<span class="action-icon fas fa-ban"></span>
						</button>
						<button class="general rounded action">
							<span class="action-text">No Specific Method</span>
						</button>
					</div>

					<!-- Item, Feat, Effect, or Spell -->
					<div class="channel weapons flex h">
						<div class="channel weapon flex h" v-if="mainhand">
							<button class="general rounded quick action item" v-on:click="info(mainhand)">
								<span class="action-icon" :class="mainhand.icon"></span>
							</button>
							<button class="general rounded action item" v-on:click="selectChannel(mainhand)">
								<span class="action-text">Main hand</span>
							</button>
						</div>
						<div class="channel weapon flex h" v-for="offhand in available_offhand">
							<button class="general rounded quick action item" v-on:click="info(offhand)">
								<span class="action-icon" :class="offhand.icon"></span>
							</button>
							<button class="general rounded action item" v-on:click="selectChannel(offhand)">
								<span class="action-text">Off hand</span>
							</button>
						</div>
					</div>
					<div class="channel toggles">
						<button class="general rounded action toggle spells"" v-on:click="toggleSpells()">
							<span class="action-text">Spells</span>
						</button>
						<button class="general rounded action toggle feats" v-on:click="toggleFeats()">
							<span class="action-text">Feats</span>
						</button>
					</div>

					<!-- Select from available -->
					<div class="flex h wrap">
						<div class="channel spells expandable" :class="show_spells?'expanded':'shrunk'">
							<button class="general rounded action channel-feat" v-if="available_spells.length === 0">
								<span class="action-icon fas fa-ban"></span>
								<span class="action-text">No Usable Spells</span>
							</button>
							<div class="channel spell flex h" v-for="spell in available_spells">
								<button class="general rounded quick action spell" v-on:click="info(spell)">
									<span class="action-icon" :class="spell.icon"></span>
								</button>
								<button class="general rounded action channel-spell" v-on:click="selectChannel(spell)">
									<span class="action-text">{{spell.name}}</span>
								</button>
							</div>
						</div>
						<div class="channel feats expandable" :class="show_feats?'expanded':'shrunk'">
							<button class="general rounded action channel-feat" v-if="available_feats.length === 0">
								<span class="action-icon fas fa-ban"></span>
								<span class="action-text">No Usable Feats</span>
							</button>
							<div class="channel feat flex h" v-for="feat in available_feats">
								<button class="general rounded quick action feat" v-on:click="info(feat)">
									<span class="action-icon" :class="feat.icon"></span>
								</button>
								<button class="general rounded action channel-feat" v-on:click="selectChannel(feat)">
									<span class="action-icon" :class="feat.icon"></span>
									<span class="action-text">{{feat.name}}</span>
								</button>
							</div>
						</div>
					</div>
				</div>
			</section>
			<section class="page targets">
				<div class="page-contents">
					<div class="section-heading">
						<span>Targets</span>
					</div>
					<!-- This may be passed in as an array of IDs "targets" -->

					<!-- Select from entities, items, spells, effects, etc. in shared location (Togglable type limited from method when known, starts as true on dialog open) -->
					<div class="targets-list">
						<div class="target flex h" v-for="target in available_targets" :class="targeting[target.id]?'targeted':''">
							<button class="general rounded quick action" v-on:click="info(target)">
								<span class="action-icon" :class="target.icon"></span>
							</button>
							<button class="general rounded action target-select" v-on:click="toggleTarget(target)">
								<span class="action-text">{{getVisibleName(target)}}</span>
								<dnd-health-bar :entity="target"></dnd-health-bar>
							</button>
						</div>
					</div>
				</div>
			</section>
			<section class="page checks">
				<div class="page-contents">
					<div class="section-heading">
						<span>Skill Checks</span>
					</div>
					<!-- Perform any necessary attack rolls (Indicate advantage here) and can force additional checks with an object "check" (Maps skill IDs). Default behavior derived from "channel" when possible. -->

				</div>
			</section>
			<section class="page damages">
				<div class="page-contents">
					<div class="section-heading">
						<span>Damage</span>
					</div>
					<!-- Roll damage based on method selection, may force base available values passing in an object "damage" (Maps damage_type IDs) -->
					<div class="damage-list flex h wrap">
						<div class="damage-container flex h" v-for="dmg in available_damages">
							<button class="general rounded quick action" v-on:click="info(dmg)">
								<span class="action-icon" :class="dmg.icon"></span>
							</button>
							<dnd-display-roll :roll="roll_damage[dmg.id]" :source="entity" :profile="profile" v-on:rollfocused="setFocus($event)"></dnd-display-roll>
						</div>
					</div>
				</div>
			</section>
			<section class="page effects">
				<div class="page-contents">
					<div class="section-heading">
						<span>Effects</span>
					</div>
					<!-- Effects to pass to the target. Defaults to a list based on method. Button to edit. Selection limited to "playable" effects. Defaults gained from "channel" -->

				</div>
			</section>
			<section class="page review">
				<div class="page-contents">
					<div class="section-heading">
						<span>Review</span>
					</div>
					<!-- -->

				</div>
			</section>
		</div>
	</div>
	<section class="dice flex h wrap centered">
		<!-- Offers buttons to quickly add dice types to a field -->
		<button class="general rounded quick action roll-add die" v-for="die in dice" :class="die.classes" v-on:click="addDie(die)":title="die.name">
			<span class="action-label">{{die.sides}}</span>
			<span class="action-icon" :class="die.icon"></span>
			<span class="action-count" v-if="focused_roll">{{focused_roll.dice_rolls[die.id]?focused_roll.dice_rolls[die.id].length:0}}</span>
		</button>
		<button class="general rounded quick action roll-add stat" v-for="stat in stats" :class="stat.classes" v-on:click="addStat(stat)" :title="stat.name + ' which is ' + stat.value">
			<span class="action-icon" :class="stat.icon"></span>
			<span class="action-text">{{stat.name}}</span>
			<span class="action-count">{{stat.value}}</span>
		</button>
	</section>
</div>
